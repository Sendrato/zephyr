# nRF9160 modem driver

The modem driver has been built to interface with the Serial LTE Modem (SLM) application by Nordic and updated by
Sendrato in order to fix some of the issue of if.

The modified version of the application is available in the [awareable-fw-nrf](https://github.com/Sendrato/awareable-fw-nrf) repository, that also allows to build
it using nRF Connect SDK v2.7.0.

## Almanac data

The driver supports writing almanac data to the modem, to decrease the time necessary to get a GPS fix.

The command can be enabled with `CONFIG_MODEM_NRF9160_EXTERNAL_ALMANAC`.
If the configuration is enabled the driver expect to find the following symbols:
1. `FACTORY_ALMANAC_DATA_V2`: containing a hex string representing the actual almanac data
2. `FACTORY_ALMANAC_DATA_CHECKSUM_V2`: containing a hex string representing the checksum of the almanac data

These symbols can be defined by including the `factory_almanac_v2.h` header file in the application that uses the
modem driver, and the content of the file should be made public (accessible across the whole project without directly
including the header file) by adding the following lines to the main CMakeLists.txt of the application:

```
# Append content of factory_almanac_v2.h to autoconf.h file, auto-generated by Kconfig system.
# This will make the defines in the file be made public by the build system and accessible
# across the whole project without including the header directly.

# First read the content of factory_almanac_v2.h
file(READ ${CMAKE_CURRENT_SOURCE_DIR}/src/factory_almanac_v2.h ALMANAC)
# Then append it to autoconf.h
file(APPEND ${AUTOCONF_H} ${ALMANAC})
```

The `factory_almanac_v2.h` header file containing updated almanac data can be copied from the GNSS sample of
nRF Connect SDK, available in `samples/cellular/gnss`. The file is located inside the `src` directory.

Factory almanac v2 must be used for `nRF9160` while v3 is used for `nRF91x1`
